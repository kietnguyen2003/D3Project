<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trực quan hóa dữ liệu</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <link rel="stylesheet" href="index.css">
</head>

<body>
  <div class="container">
    <div class="idiom" id="i1">
      <h1 class="title">1. Brand nhận được sự quan tâm của mọi người</h1>
      <select name="chart-options" id="chart-selector">
        <option value="all">All</option>
        <option value="Rating">Rating</option>
        <option value="Reviews">Reviews</option>
        <option value="Stars">Stars</option>
      </select>
      <select name="chart-options2" id="chart-selector2">
        <option value="all">All</option>
        <option value="Rating">Rating</option>
        <option value="Reviews">Reviews</option>
        <option value="Stars">Stars</option>
      </select>
      <div class="chart" id="chart1"></div>
      <div class="comment" id="comment1">
        <label for="nhanxet">Nhận xét 1 </label>
        <div class="nhanxet"> Dựa trên dữ liệu, Apple là thương hiệu được quan tâm nhất với lượng đánh giá (Rating) cao
          nhất là 5,689,393 và 276,380 lượt đánh giá chi tiết (Reviews), tiếp theo là vivo với 4,530,263 Rating và
          264,831 Reviews, chứng tỏ sức hút lớn của hai thương hiệu này. Motorola, realme, và SAMSUNG cũng nhận được sự
          chú ý đáng kể, đặc biệt ở phân khúc tầm trung. Trong khi đó, các thương hiệu như Google, LAVA, và itel có mức
          độ quan tâm trung bình, chủ yếu nhắm vào thị trường khác. Tuy nhiên, một số thương hiệu như I, Vox, và
          KARBONN hầu như không được biết đến, với số lượt đánh giá và bình luận rất thấp, cho thấy mức độ phổ biến gần
          như không có.</div>
      </div>
    </div>
    <div class="idiom" id="i2">
      <div class="chart" id="chart2"></div>
      <div class="comment" id="comment2">
        <label for="nhanxet">Nhận xét 2 </label>
        <div class="nhanxet"></div>
      </div>
    </div>
    <div class="idiom" id="i3">
      <div class="chart" id="chart3"></div>
      <div class="comment" id="comment3">
        <label for="nhanxet">Nhận xét 3 </label>
        <div class="nhanxet"></div>
      </div>
    </div>
    <div class="idiom" id="i4">
      <div class="chart" id="chart4"></div>
      <div class="comment" id="comment4">
        <label for="nhanxet">Nhận xét 4 </label>
        <div class="nhanxet"></div>
      </div>
    </div>
  </div>

  <script type="module">
    import { drawBarLineChart, drawBarChart, drawTreemap } from './index.js'; // Import các hàm vẽ

    const dataPath = "data.json"; // Đường dẫn đến file JSON chứa dữ liệu

    d3.json(dataPath).then(data => {
      console.log("Dữ liệu:", data); // Kiểm tra dữ liệu

      // Hàm cập nhật biểu đồ dựa trên hai selector
      const updateChart = () => {
        // Lấy giá trị từ hai selector
        const option1 = d3.select("#chart-selector").property("value");
        const option2 = d3.select("#chart-selector2").property("value");

        // Xóa nội dung cũ trong chart1
        d3.select("#chart1").selectAll("*").remove();

        if (option1 === "all" || option2 === "all") {
          // Nếu một trong hai selector chọn "All", hiển thị Treemap
          drawTreemap(data, "#chart1");
        } else if (option1 === option2) {
          // Nếu cả hai selector chọn cùng một giá trị, hiển thị Bar Chart
          drawBarChart(data, "#chart1", option1, `Biểu đồ ${option1}`);
        } else {
          // Nếu hai selector chọn hai giá trị khác nhau, hiển thị Bar-Line Chart
          drawBarLineChart(
            data,
            "#chart1",
            option1,
            option2,
            `Biểu đồ ${option1}`,
            `Biểu đồ ${option2}`
          );
        }
      };

      // Lắng nghe sự kiện thay đổi trên cả hai selector
      d3.select("#chart-selector").on("change", updateChart);
      d3.select("#chart-selector2").on("change", updateChart);

      // Hiển thị biểu đồ mặc định (Treemap)
      updateChart();
    }).catch(error => {
      console.error("Lỗi khi đọc file JSON:", error);
    });
  </script>


</body>

</html>